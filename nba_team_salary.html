<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Garry Chan">
  <meta name="description" content="Posts by Garry Chan">
  <title>
    Garry's Blog
&ndash; Do NBA teams with greater team salaries win more?  </title>

    <link rel="canonical" href="https://garrrychan.github.io/blog/nba_team_salary.html">

  <link href="//fonts.googleapis.com/css?family=Open+Sans:600,800" rel="stylesheet" type="text/css">
  <!------>
  <link rel="shortcut icon" href="https://garrrychan.github.io/blog/theme/images/gary_snail.png">  <link rel="stylesheet" type="text/css" href="https://garrrychan.github.io/blog/theme/css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="https://garrrychan.github.io/blog/theme/css/all.css">
  <link rel="stylesheet" type="text/css" href="https://garrrychan.github.io/blog/theme/css/pygments-monokai.css">
</head>
<body>
  <div class="container">
    <div class="four columns sidebar">
<nav>
  <a href="https://garrrychan.github.io/blog/">
    <img src="https://garrrychan.github.io/blog/theme/images/logo.png" id="gravatar" alt="photo"/>
  </a>
  <h2><a href="https://garrrychan.github.io/blog/">Garry Chan</a></h2>

  <div id="bio">
    <p>I write about data science, and occasionally sports.</p>
    <p>Completed a full time data science program.</p>
    <p>Experience as a tech consultant, with a Bachelors in Mathematics from UWaterloo.</p>
  </div>

  <div id="social">
    <div>
      <i class="fas fa-map-marker-alt fa-2x" style="color:#48A9A6">
      <span class="location_icon"> <font color=#000> Toronto, Canada </font></span> </i>
      </div>
    <br>
    <a title="Garry on LinkedIn" href="https://www.linkedin.com/in/garrrychan">
      <!--- icons from font awesome are really just fonts fa-2x the size--->
    <i class="fab fa-linkedin fa-2x"></i></a>

    &nbsp &nbsp;
    <a title="Garry on Github" href="https://github.com/garrrychan">
    <i class="fab fa-github fa-2x"></i></a>

    &nbsp &nbsp;
    <a title="Garry's Email" href="mailto: g33chan@uwaterloo.ca">
    <i class="fas fa-envelope-square fa-2x"></i>
    </a>
  </div>
</nav>    </div>

    <div class="eleven columns content">
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
  <p class="meta">
    30 March 2019
    <a href="https://garrrychan.github.io/blog">
      <!--- home icon--->
      <i class="home fa fa-home fa-2x"></i>
    </a>
  </p>

  <h1 class="title"><a href="https://garrrychan.github.io/blog/nba_team_salary.html">Do NBA teams with greater team salaries win more?</a></h1>

  <div class="article_text" id="post">
    <p>FiveThirtyEight is one of my favourite places to read thoughtful analysis, and see data visualizations. I was inspired by one of their posts on <a href="https://fivethirtyeight.com/features/how-your-favorite-baseball-team-blows-its-money/">'how your favourite baseball team blows its money'</a>. As an avid basketball fan, I recreated this graphic with NBA data. </p>
<p>This was incredible practice with Matplotlib. Thank you to Amy Gordon for her <a href="https://github.com/ag2816/">Github</a> for the style guide.</p>
<h3>Background</h3>
<p><img src="images/nba_team_salary_40_0.svg" alt="nba_salary" class="img-responsive"></p>
<p>This chart illustrates the relationship between team spending and win percentage for each basketball season from 2001 - 2015. Essentially, the steeper the curve, the better the team was maximizing value. </p>
<ul>
<li>Each regular season is one dot in the figure</li>
<li>Salaries are inflation adjusted, and standardized.</li>
<li>The coloured line in each chart represents the linear regression fit for a team</li>
<li>The grey line represents the linear regression fit for the league in aggregate</li>
</ul>
<p>More money, more wins. There is a rough trend suggesting that higher team salaries lead to a greater winning percentage. This relationship is particularly strong for the Boston Celtics and Golden State Warriors.</p>
<p>On the other hand, this relationship is flat for others. For example, irrespective of team salary, the San Antonio Spurs is a winning organization. They are better at managing its roster and payroll versus others. They pride themselves with developing talent organically with scouting, coaching, and player development. Rather than overpaying Superstar players in the free agency market, they sign undervalued players (players who contribute more to win share, relatively their salary would suggest). This is similar to the thinking in MoneyBall, and has been widely studied in sports. Coupled with the fact that there is usually a salary cap limit in professional sports, this becomes a very interesting dynamic. </p>
<p>Worst out of all the teams, New York Knicks tend to overpay players, which don't yield any marginal wins on the court and underperform relative to expectations.</p>
<hr>
<h4>Data</h4>
<p>Game Data:
https://www.kaggle.com/fivethirtyeight/fivethirtyeight-nba-elo-dataset</p>
<p>Salary data (exported to CSV):
https://hoopshype.com/salaries/</p>
<p>For those interested, keep reading for data wrangling and snippets of code.
<br></p>
<hr>
<h3>1. Load &amp; prepare data</h3>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="c1"># blog html visualization </span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="c1"># plt.rcParams[&#39;figure.dpi&#39;] = 50</span>
<span class="c1"># %config InlineBackend.figure_format = &#39;retina&#39;</span>
<span class="o">%</span><span class="n">config</span> <span class="n">InlineBackend</span><span class="o">.</span><span class="n">figure_format</span> <span class="o">=</span> <span class="s1">&#39;svg&#39;</span>
</pre></div>


<p>Salary data</p>
<div class="highlight"><pre><span></span><span class="n">raw</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/nba_team_salary.csv&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># reorganize columns in chronological order</span>
<span class="n">salary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">raw</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">],</span> <span class="n">raw</span><span class="p">[</span><span class="n">raw</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># change NaN to zero for no salary expansion teams: Charlotte 2003, 2004; New Orleans 2001, 2002</span>
<span class="n">salary</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;$0&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># rename city to mascot name to merge later with games dataset</span>
<span class="n">teams</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;team&quot;</span><span class="p">:[</span><span class="s2">&quot;Hawks&quot;</span><span class="p">,</span><span class="s2">&quot;Celtics&quot;</span><span class="p">,</span><span class="s2">&quot;Nets&quot;</span><span class="p">,</span><span class="s2">&quot;Hornets&quot;</span><span class="p">,</span><span class="s2">&quot;Bulls&quot;</span><span class="p">,</span><span class="s2">&quot;Cavaliers&quot;</span><span class="p">,</span><span class="s2">&quot;Mavericks&quot;</span><span class="p">,</span><span class="s2">&quot;Nuggets&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;Pistons&quot;</span><span class="p">,</span><span class="s2">&quot;Warriors&quot;</span><span class="p">,</span><span class="s2">&quot;Rockets&quot;</span><span class="p">,</span><span class="s2">&quot;Pacers&quot;</span><span class="p">,</span><span class="s2">&quot;Clippers&quot;</span><span class="p">,</span><span class="s2">&quot;Lakers&quot;</span><span class="p">,</span><span class="s2">&quot;Grizzlies&quot;</span><span class="p">,</span><span class="s2">&quot;Heat&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;Bucks&quot;</span><span class="p">,</span><span class="s2">&quot;Timberwolves&quot;</span><span class="p">,</span><span class="s2">&quot;Pelicans&quot;</span><span class="p">,</span><span class="s2">&quot;Knicks&quot;</span><span class="p">,</span><span class="s2">&quot;Thunder&quot;</span><span class="p">,</span><span class="s2">&quot;Magic&quot;</span><span class="p">,</span><span class="s2">&quot;Sixers&quot;</span><span class="p">,</span><span class="s2">&quot;Suns&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;Trailblazers&quot;</span><span class="p">,</span><span class="s2">&quot;Kings&quot;</span><span class="p">,</span><span class="s2">&quot;Spurs&quot;</span><span class="p">,</span><span class="s2">&quot;Raptors&quot;</span><span class="p">,</span><span class="s2">&quot;Jazz&quot;</span><span class="p">,</span><span class="s2">&quot;Wizards&quot;</span><span class="p">]}</span>

<span class="n">salary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">teams</span><span class="p">),</span><span class="n">salary</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="p">]],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># transform wide to long data for plotting</span>
<span class="c1"># 450 columns: 30 teams x 15 years</span>
<span class="n">long_salary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">salary</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;team&#39;</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;salary&#39;</span><span class="p">)</span>
<span class="n">long_salary</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># year into int</span>
<span class="n">long_salary</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">long_salary</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="c1"># salary into int</span>
<span class="n">long_salary</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">long_salary</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)))</span>
</pre></div>


<hr>
<p>To make the data more comparable year over year, let's standardize the salaries. This function calculates how many standard deviations a team's salary is from the league average for a given year and returns that value. </p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">z_salary</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">year</span><span class="p">,</span><span class="n">salary</span><span class="p">):</span>
    <span class="n">year_mean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">year</span><span class="p">)][</span><span class="s1">&#39;salary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">year_std</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">year</span><span class="p">)][</span><span class="s1">&#39;salary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">salary</span> <span class="o">-</span> <span class="n">year_mean</span><span class="p">)</span><span class="o">/</span><span class="n">year_std</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">long_salary</span><span class="p">[</span><span class="s1">&#39;z_salary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">long_salary</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">z_salary</span><span class="p">(</span><span class="n">long_salary</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;salary&quot;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">long_salary</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">classes</span><span class="o">=</span><span class="s2">&quot;table table-responsive table-striped table-bordered&quot;</span><span class="p">))</span>
</pre></div>


<table border="1" class="dataframe table table-responsive table-striped table-bordered">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>team</th>
      <th>year</th>
      <th>salary</th>
      <th>z_salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Hawks</td>
      <td>2001</td>
      <td>57438766</td>
      <td>-0.689421</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Celtics</td>
      <td>2001</td>
      <td>75244004</td>
      <td>0.086161</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Nets</td>
      <td>2001</td>
      <td>100821283</td>
      <td>1.200288</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hornets</td>
      <td>2001</td>
      <td>67881439</td>
      <td>-0.234546</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Bulls</td>
      <td>2001</td>
      <td>43399261</td>
      <td>-1.300970</td>
    </tr>
  </tbody>
</table>

<div class="highlight"><pre><span></span><span class="c1"># export to csv </span>
<span class="n">long_salary</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;./data/nba_team_salary_final.csv&quot;</span><span class="p">)</span>
</pre></div>


<hr>
<p>Games data</p>
<p>From this NBA Elo dataset from Kaggle on FiveThirtyEight, I'll need to tally the following for each season. 
* G: Games play
* W: Games won
* L: Games lost</p>
<p>In the future, I'll be web scraping, which will make this easier. </p>
<div class="highlight"><pre><span></span><span class="n">games</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/nba_elo.csv&#39;</span><span class="p">)</span>

<span class="c1"># I&#39;ll only look at the regular season to keep n consistent across teams</span>
<span class="n">games</span> <span class="o">=</span> <span class="n">games</span><span class="p">[</span><span class="n">games</span><span class="p">[</span><span class="s2">&quot;is_playoffs&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># This dataset has a lot of extraneous information, so I&#39;ll focus on the columns of interest. </span>
<span class="n">games</span> <span class="o">=</span> <span class="n">games</span><span class="p">[[</span><span class="s2">&quot;year_id&quot;</span><span class="p">,</span><span class="s2">&quot;date_game&quot;</span><span class="p">,</span><span class="s2">&quot;team_id&quot;</span><span class="p">,</span><span class="s2">&quot;fran_id&quot;</span><span class="p">,</span><span class="s2">&quot;opp_id&quot;</span><span class="p">,</span><span class="s2">&quot;opp_fran&quot;</span><span class="p">,</span><span class="s2">&quot;game_result&quot;</span><span class="p">]]</span>

<span class="c1"># This dataset is from 1947-2019, so I&#39;ll filter for years 2001 to 2015 to match our Salary data</span>
<span class="n">games</span> <span class="o">=</span> <span class="n">games</span><span class="p">[(</span><span class="n">games</span><span class="p">[</span><span class="s2">&quot;year_id&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2001</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">games</span><span class="p">[</span><span class="s2">&quot;year_id&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2015</span><span class="p">)]</span>

<span class="n">HTML</span><span class="p">(</span><span class="n">games</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">classes</span><span class="o">=</span><span class="s2">&quot;table table-responsive table-striped table-bordered&quot;</span><span class="p">))</span>
</pre></div>


<table border="1" class="dataframe table table-responsive table-striped table-bordered">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year_id</th>
      <th>date_game</th>
      <th>team_id</th>
      <th>fran_id</th>
      <th>opp_id</th>
      <th>opp_fran</th>
      <th>game_result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>87750</th>
      <td>2001</td>
      <td>10/31/2000</td>
      <td>ATL</td>
      <td>Hawks</td>
      <td>CHH</td>
      <td>Pelicans</td>
      <td>L</td>
    </tr>
    <tr>
      <th>87751</th>
      <td>2001</td>
      <td>10/31/2000</td>
      <td>CHH</td>
      <td>Pelicans</td>
      <td>ATL</td>
      <td>Hawks</td>
      <td>W</td>
    </tr>
    <tr>
      <th>87752</th>
      <td>2001</td>
      <td>10/31/2000</td>
      <td>CHI</td>
      <td>Bulls</td>
      <td>SAC</td>
      <td>Kings</td>
      <td>L</td>
    </tr>
    <tr>
      <th>87753</th>
      <td>2001</td>
      <td>10/31/2000</td>
      <td>SAC</td>
      <td>Kings</td>
      <td>CHI</td>
      <td>Bulls</td>
      <td>W</td>
    </tr>
    <tr>
      <th>87754</th>
      <td>2001</td>
      <td>10/31/2000</td>
      <td>DAL</td>
      <td>Mavericks</td>
      <td>MIL</td>
      <td>Bucks</td>
      <td>W</td>
    </tr>
  </tbody>
</table>

<div class="highlight"><pre><span></span><span class="c1"># reset record to beginning with list comphrension</span>
<span class="n">record</span> <span class="o">=</span> <span class="p">{</span><span class="n">team</span><span class="p">:{</span><span class="s2">&quot;G&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;W&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;L&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">teams</span><span class="p">}</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># Each game shows up for the home and away team, so I&#39;ll only need to run control flow for when they lose</span>
<span class="c1"># Repeat for each year</span>

<span class="k">def</span> <span class="nf">create_record</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">games</span><span class="p">[</span><span class="n">games</span><span class="p">[</span><span class="s2">&quot;year_id&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">year</span><span class="p">]</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">game_result</span> <span class="o">==</span> <span class="s2">&quot;L&quot;</span><span class="p">:</span>
            <span class="n">record</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">fran_id</span><span class="p">][</span><span class="s2">&quot;G&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">record</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">opp_fran</span><span class="p">][</span><span class="s2">&quot;G&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">record</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">fran_id</span><span class="p">][</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">record</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">opp_fran</span><span class="p">][</span><span class="s2">&quot;W&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">record</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># set up list of each team and each year</span>
<span class="n">teams</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">games</span><span class="o">.</span><span class="n">fran_id</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
<span class="n">all_years</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">games</span><span class="o">.</span><span class="n">year_id</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># now repeat for all the years in a dictionary object</span>
<span class="n">seasons</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">all_years</span><span class="p">:</span>
    <span class="n">record</span> <span class="o">=</span> <span class="p">{</span><span class="n">team</span><span class="p">:{</span><span class="s2">&quot;G&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;W&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;L&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span> <span class="k">for</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">teams</span><span class="p">}</span>
    <span class="n">seasons</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_record</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">create_record</span><span class="p">(</span><span class="mi">2001</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>{&#39;Bucks&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 93, &#39;L&#39;: 71},
 &#39;Bulls&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 65, &#39;L&#39;: 99},
 &#39;Cavaliers&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 83, &#39;L&#39;: 81},
 &#39;Celtics&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 76, &#39;L&#39;: 88},
 &#39;Clippers&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 87, &#39;L&#39;: 77},
 &#39;Grizzlies&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 78, &#39;L&#39;: 86},
 &#39;Hawks&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 85, &#39;L&#39;: 79},
 &#39;Heat&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 87, &#39;L&#39;: 77},
 &#39;Hornets&#39;: {&#39;G&#39;: 82, &#39;W&#39;: 33, &#39;L&#39;: 49},
 &#39;Jazz&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 91, &#39;L&#39;: 73},
 &#39;Kings&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 84, &#39;L&#39;: 80},
 &#39;Knicks&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 65, &#39;L&#39;: 99},
 &#39;Lakers&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 77, &#39;L&#39;: 87},
 &#39;Magic&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 68, &#39;L&#39;: 96},
 &#39;Mavericks&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 103, &#39;L&#39;: 61},
 &#39;Nets&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 64, &#39;L&#39;: 100},
 &#39;Nuggets&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 70, &#39;L&#39;: 94},
 &#39;Pacers&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 79, &#39;L&#39;: 85},
 &#39;Pelicans&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 91, &#39;L&#39;: 73},
 &#39;Pistons&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 64, &#39;L&#39;: 100},
 &#39;Raptors&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 96, &#39;L&#39;: 68},
 &#39;Rockets&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 101, &#39;L&#39;: 63},
 &#39;Sixers&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 74, &#39;L&#39;: 90},
 &#39;Spurs&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 113, &#39;L&#39;: 51},
 &#39;Suns&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 90, &#39;L&#39;: 74},
 &#39;Thunder&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 89, &#39;L&#39;: 75},
 &#39;Timberwolves&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 63, &#39;L&#39;: 101},
 &#39;Trailblazers&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 101, &#39;L&#39;: 63},
 &#39;Warriors&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 84, &#39;L&#39;: 80},
 &#39;Wizards&#39;: {&#39;G&#39;: 164, &#39;W&#39;: 65, &#39;L&#39;: 99}}
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># rename index column to team</span>
<span class="n">df_seasons</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">seasons</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;team&#39;</span><span class="p">})</span>

<span class="c1"># wide to long data for plotting</span>
<span class="n">long_seasons</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">df_seasons</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;team&#39;</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;seasons&#39;</span><span class="p">)</span>

<span class="c1"># Break out the G,W,L into columns</span>
<span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">long_seasons</span><span class="p">[</span><span class="s2">&quot;seasons&quot;</span><span class="p">])</span>

<span class="n">long_seasons</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">])</span>
<span class="n">long_seasons</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">])</span>
<span class="n">long_seasons</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">])</span>

<span class="c1"># Calculate winning % for each team per year, and add as a new column</span>
<span class="n">long_seasons</span><span class="p">[</span><span class="s1">&#39;win_%&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">long_seasons</span><span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">long_seasons</span><span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># drop seasons, redundant column with G, L, W</span>
<span class="n">long_seasons</span> <span class="o">=</span> <span class="n">long_seasons</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;seasons&#39;</span><span class="p">])</span>

<span class="c1"># make year into int so it can be merged later</span>
<span class="n">long_seasons</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">long_seasons</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">HTML</span><span class="p">(</span><span class="n">long_seasons</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">classes</span><span class="o">=</span><span class="s2">&quot;table table-responsive table-striped table-bordered&quot;</span><span class="p">))</span>
</pre></div>


<table border="1" class="dataframe table table-responsive table-striped table-bordered">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>team</th>
      <th>year</th>
      <th>G</th>
      <th>L</th>
      <th>W</th>
      <th>win_%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bucks</td>
      <td>2001</td>
      <td>82</td>
      <td>30</td>
      <td>52</td>
      <td>0.63</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bulls</td>
      <td>2001</td>
      <td>82</td>
      <td>67</td>
      <td>15</td>
      <td>0.18</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cavaliers</td>
      <td>2001</td>
      <td>82</td>
      <td>52</td>
      <td>30</td>
      <td>0.37</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Celtics</td>
      <td>2001</td>
      <td>82</td>
      <td>46</td>
      <td>36</td>
      <td>0.44</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Clippers</td>
      <td>2001</td>
      <td>82</td>
      <td>51</td>
      <td>31</td>
      <td>0.38</td>
    </tr>
  </tbody>
</table>

<p>Now, I'll merge the two datasets (long_salary, long_seasons) together into one dataframe for scatterplots</p>
<div class="highlight"><pre><span></span><span class="c1"># merge datasets together</span>
<span class="n">final</span> <span class="o">=</span> <span class="n">long_salary</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">long_seasons</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">,</span><span class="s2">&quot;year&quot;</span><span class="p">])</span>
<span class="n">final</span>

<span class="c1"># add divisions data</span>
<span class="n">divisions_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Atlantic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Celtics&quot;</span><span class="p">,</span><span class="s2">&quot;Nets&quot;</span><span class="p">,</span><span class="s2">&quot;Sixers&quot;</span><span class="p">,</span><span class="s2">&quot;Raptors&quot;</span><span class="p">,</span><span class="s2">&quot;Knicks&quot;</span><span class="p">],</span>
             <span class="s2">&quot;Central&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Bulls&quot;</span><span class="p">,</span><span class="s2">&quot;Cavaliers&quot;</span><span class="p">,</span><span class="s2">&quot;Pistons&quot;</span><span class="p">,</span><span class="s2">&quot;Bucks&quot;</span><span class="p">,</span><span class="s2">&quot;Pacers&quot;</span><span class="p">],</span>
             <span class="s2">&quot;Southeast&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hawks&quot;</span><span class="p">,</span><span class="s2">&quot;Hornets&quot;</span><span class="p">,</span><span class="s2">&quot;Heat&quot;</span><span class="p">,</span><span class="s2">&quot;Magic&quot;</span><span class="p">,</span><span class="s2">&quot;Wizards&quot;</span><span class="p">],</span>
             <span class="s2">&quot;Northwest&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Timberwolves&quot;</span><span class="p">,</span><span class="s2">&quot;Nuggets&quot;</span><span class="p">,</span><span class="s2">&quot;Trailblazers&quot;</span><span class="p">,</span><span class="s2">&quot;Thunder&quot;</span><span class="p">,</span><span class="s2">&quot;Jazz&quot;</span><span class="p">],</span>
             <span class="s2">&quot;Pacific&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Warriors&quot;</span><span class="p">,</span><span class="s2">&quot;Clippers&quot;</span><span class="p">,</span><span class="s2">&quot;Lakers&quot;</span><span class="p">,</span><span class="s2">&quot;Kings&quot;</span><span class="p">,</span><span class="s2">&quot;Suns&quot;</span><span class="p">],</span>
             <span class="s2">&quot;Southwest&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Mavericks&quot;</span><span class="p">,</span> <span class="s2">&quot;Rockets&quot;</span><span class="p">,</span><span class="s2">&quot;Grizzlies&quot;</span><span class="p">,</span><span class="s2">&quot;Pelicans&quot;</span><span class="p">,</span><span class="s2">&quot;Spurs&quot;</span><span class="p">]}</span>

<span class="n">divisions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Atlantic&quot;</span><span class="p">,</span><span class="s2">&quot;Central&quot;</span><span class="p">,</span><span class="s2">&quot;Southeast&quot;</span><span class="p">,</span><span class="s2">&quot;Northwest&quot;</span><span class="p">,</span><span class="s2">&quot;Pacific&quot;</span><span class="p">,</span><span class="s2">&quot;Southwest&quot;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">team_to_division</span><span class="p">(</span><span class="n">team</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">divisions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">divisions_dict</span><span class="p">[</span><span class="n">division</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">division</span>

<span class="n">final</span><span class="p">[</span><span class="s2">&quot;division&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">final</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">team_to_division</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="c1"># add conference data</span>
<span class="n">conferences</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;East&quot;</span><span class="p">,</span><span class="s2">&quot;West&quot;</span><span class="p">]</span>
<span class="n">conferences_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;East&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Celtics&quot;</span><span class="p">,</span><span class="s2">&quot;Nets&quot;</span><span class="p">,</span><span class="s2">&quot;Sixers&quot;</span><span class="p">,</span><span class="s2">&quot;Raptors&quot;</span><span class="p">,</span><span class="s2">&quot;Knicks&quot;</span><span class="p">,</span><span class="s2">&quot;Bulls&quot;</span><span class="p">,</span><span class="s2">&quot;Cavaliers&quot;</span><span class="p">,</span><span class="s2">&quot;Pistons&quot;</span><span class="p">,</span><span class="s2">&quot;Bucks&quot;</span><span class="p">,</span><span class="s2">&quot;Pacers&quot;</span><span class="p">,</span><span class="s2">&quot;Hawks&quot;</span><span class="p">,</span><span class="s2">&quot;Hornets&quot;</span><span class="p">,</span><span class="s2">&quot;Heat&quot;</span><span class="p">,</span><span class="s2">&quot;Magic&quot;</span><span class="p">,</span><span class="s2">&quot;Wizards&quot;</span><span class="p">],</span>
                   <span class="s2">&quot;West&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Timberwolves&quot;</span><span class="p">,</span><span class="s2">&quot;Nuggets&quot;</span><span class="p">,</span><span class="s2">&quot;Trailblazers&quot;</span><span class="p">,</span><span class="s2">&quot;Thunder&quot;</span><span class="p">,</span><span class="s2">&quot;Jazz&quot;</span><span class="p">,</span><span class="s2">&quot;Warriors&quot;</span><span class="p">,</span><span class="s2">&quot;Clippers&quot;</span><span class="p">,</span><span class="s2">&quot;Lakers&quot;</span><span class="p">,</span><span class="s2">&quot;Kings&quot;</span><span class="p">,</span><span class="s2">&quot;Suns&quot;</span><span class="p">,</span><span class="s2">&quot;Mavericks&quot;</span><span class="p">,</span> <span class="s2">&quot;Rockets&quot;</span><span class="p">,</span><span class="s2">&quot;Grizzlies&quot;</span><span class="p">,</span><span class="s2">&quot;Pelicans&quot;</span><span class="p">,</span><span class="s2">&quot;Spurs&quot;</span><span class="p">]}</span>

<span class="k">def</span> <span class="nf">division_to_conference</span><span class="p">(</span><span class="n">division</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">conference</span> <span class="ow">in</span> <span class="n">conferences</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">conferences_dict</span><span class="p">[</span><span class="n">conference</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">conference</span>

<span class="n">final</span><span class="p">[</span><span class="s2">&quot;conference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">final</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">division_to_conference</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># Remove early Charlotte Hornet years, missing data;</span>
<span class="c1"># they relocated to New Orleans, and were renamed as the Pelicans</span>
<span class="n">final</span><span class="p">[</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Hornets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="mi">93</span><span class="p">]]</span>
<span class="n">final</span> <span class="o">=</span> <span class="n">final</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="mi">93</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">final</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;./data/final.csv&quot;</span><span class="p">)</span>
</pre></div>


<hr>
<h3>2. Create plot for one team</h3>
<ul>
<li>Use matplotlib, a Python 2D plotting library</li>
<li>Create a scatterplot for the Raptors</li>
</ul>
<div class="highlight"><pre><span></span><span class="n">raptors</span> <span class="o">=</span> <span class="n">final</span><span class="p">[</span><span class="n">final</span><span class="p">[</span><span class="s1">&#39;team&#39;</span><span class="p">]</span><span class="o">==</span> <span class="s1">&#39;Raptors&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># change way we invoke plot so can manipulate the axis</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1">#ax.scatter(x, y)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">raptors</span><span class="p">[</span><span class="s1">&#39;z_salary&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">raptors</span><span class="p">[</span><span class="s1">&#39;win_%&#39;</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s2">&quot;#CE1141&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Toronto Raptors&#39;</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Standardized Salaries&quot;</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Win %&#39;</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>

<span class="c1"># add linear regression line</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Raptors&quot;</span><span class="p">][</span><span class="s2">&quot;z_salary&quot;</span><span class="p">])</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">raptors</span><span class="p">[</span><span class="s2">&quot;win_%&quot;</span><span class="p">])</span>
<span class="n">linreg</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">linreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#CE1141&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># remove the top and right borders</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># add in gridlines</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># create cross hairs </span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># reduce ticks on x axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p><img alt="svg" src="images/nba_team_salary_30_0.svg"></p>
<p>Compare this with the plot for the league </p>
<div class="highlight"><pre><span></span><span class="c1"># change way we invoke plot so can manipulate the axis</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1">#ax.scatter(x, y)</span>
<span class="n">scatter_league</span> <span class="o">=</span> <span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">final</span><span class="p">[</span><span class="s1">&#39;z_salary&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">final</span><span class="p">[</span><span class="s1">&#39;win_%&#39;</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s2">&quot;#000000&quot;</span><span class="p">),</span>
                  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;NBA League&#39;</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
                  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Standardized Salaries&quot;</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">),</span>
                  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Win %&#39;</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">))</span>

<span class="c1"># add linear regression line</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;z_salary&quot;</span><span class="p">])</span>
<span class="n">Y_league</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;win_%&quot;</span><span class="p">])</span>
<span class="n">linreg</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">linreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y_league</span><span class="p">)</span>
<span class="n">predictions_league</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># remove the top and right borders</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># add in gridlines</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># create cross hairs </span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># reduce ticks on x axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>

<span class="n">league_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">predictions_league</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#000000&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p><img alt="svg" src="images/nba_team_salary_32_0.svg"></p>
<hr>
<h3>3. Generate plots for all the teams in a division, in a row</h3>
<div class="highlight"><pre><span></span><span class="c1"># Create a dictionary with the team names, and team plot colour. I&#39;ll do this with Atlantic, </span>
<span class="c1"># then loop through each division on each row</span>

<span class="n">atlantic</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Celtics&quot;</span><span class="p">:</span> <span class="s2">&quot;#007A33&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Nets&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Sixers&quot;</span><span class="p">:</span> <span class="s2">&quot;#006BB6&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Raptors&quot;</span><span class="p">:</span> <span class="s2">&quot;#CE1141&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Knicks&quot;</span><span class="p">:</span> <span class="s2">&quot;#F58426&quot;</span><span class="p">}</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_team_row</span><span class="p">(</span><span class="n">team_df</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span><span class="n">team_color</span><span class="o">=</span><span class="s1">&#39;#00000&#39;</span><span class="p">):</span>

    <span class="c1"># linear regression</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">team_df</span><span class="p">[</span><span class="s2">&quot;z_salary&quot;</span><span class="p">])</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">team_df</span><span class="p">[</span><span class="s2">&quot;win_%&quot;</span><span class="p">])</span>
    <span class="n">linreg</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">linreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">team_color</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>    

    <span class="c1"># plot league average</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s1">&#39;z_salary&#39;</span><span class="p">]),</span> <span class="n">predictions_league</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#C4CED4&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>

    <span class="c1"># scatterplot</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">team_df</span><span class="p">[</span><span class="s1">&#39;z_salary&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">team_df</span><span class="p">[</span><span class="s1">&#39;win_%&#39;</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">team_color</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># title for each team subplot</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{team_df[&#39;team&#39;].values[0]}&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># create cross hairs</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">10</span><span class="p">,</span><span class="o">.</span><span class="mi">90</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># ticks</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>

    <span class="c1"># remove borders</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

    <span class="c1"># add in gridlines</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>


<ul>
<li>Outside of the loop, instantiate the plot with 1 row x 5 columns each of the teams in the division</li>
<li>The <code>ax</code> object is an array with each array defining one subplot</li>
<li>These arrays can be passed into to the previous <code>plot_team_row()</code> function</li>
</ul>
<div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># Division title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">0.48</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Atlantic&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>

<span class="c1"># Spacing for subplots</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=.</span><span class="mo">001</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.825</span><span class="p">)</span>

<span class="c1"># pos determines which axes object to pass into the function</span>
<span class="c1">#there are 5 pos</span>
<span class="n">col</span><span class="o">=</span><span class="mi">0</span> 
<span class="k">for</span> <span class="n">team</span><span class="p">,</span> <span class="n">colour</span> <span class="ow">in</span> <span class="n">atlantic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">plot_team_row</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="n">final</span><span class="p">[</span><span class="s1">&#39;team&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">team</span><span class="p">],</span> <span class="n">ax</span><span class="p">[</span><span class="n">col</span><span class="p">],</span><span class="n">colour</span><span class="p">)</span>
    <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="o">+</span><span class="mi">1</span> 

<span class="c1"># force label to appear on first plot rather than the last plot</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Standardized Salaries&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Win %&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p><img alt="svg" src="images/nba_team_salary_37_0.svg"></p>
<hr>
<h3>4. Create the full chart for the entire NBA</h3>
<div class="highlight"><pre><span></span><span class="c1"># team colours source: https://teamcolorcodes.com/</span>

<span class="n">atlantic</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Celtics&quot;</span><span class="p">:</span> <span class="s2">&quot;#007A33&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Nets&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Sixers&quot;</span><span class="p">:</span> <span class="s2">&quot;#006BB6&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Raptors&quot;</span><span class="p">:</span> <span class="s2">&quot;#CE1141&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Knicks&quot;</span><span class="p">:</span> <span class="s2">&quot;#F58426&quot;</span><span class="p">}</span>

<span class="n">central</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Bulls&quot;</span><span class="p">:</span> <span class="s2">&quot;#CE1141&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Cavaliers&quot;</span><span class="p">:</span> <span class="s2">&quot;#6F263D&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Pistons&quot;</span><span class="p">:</span> <span class="s2">&quot;#C8102E&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Bucks&quot;</span><span class="p">:</span> <span class="s2">&quot;#00471B&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Pacers&quot;</span><span class="p">:</span> <span class="s2">&quot;#FDBB30&quot;</span><span class="p">}</span>

<span class="n">southeast</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Hawks&quot;</span><span class="p">:</span> <span class="s2">&quot;#E03A3E&quot;</span><span class="p">,</span>
             <span class="s2">&quot;Hornets&quot;</span><span class="p">:</span><span class="s2">&quot;#00788C&quot;</span><span class="p">,</span>
             <span class="s2">&quot;Heat&quot;</span><span class="p">:</span> <span class="s2">&quot;#98002E&quot;</span><span class="p">,</span>
             <span class="s2">&quot;Magic&quot;</span><span class="p">:</span> <span class="s2">&quot;#0077C0&quot;</span><span class="p">,</span>
             <span class="s2">&quot;Wizards&quot;</span><span class="p">:</span> <span class="s2">&quot;#002B5C&quot;</span><span class="p">}</span>

<span class="n">northwest</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Timberwolves&quot;</span><span class="p">:</span> <span class="s2">&quot;#236192&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Nuggets&quot;</span><span class="p">:</span> <span class="s2">&quot;#FEC524&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Trailblazers&quot;</span><span class="p">:</span> <span class="s2">&quot;#E03A3E&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Thunder&quot;</span><span class="p">:</span> <span class="s2">&quot;#007AC1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Jazz&quot;</span><span class="p">:</span> <span class="s2">&quot;#00471B&quot;</span><span class="p">}</span>

<span class="n">pacific</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Warriors&quot;</span><span class="p">:</span> <span class="s2">&quot;#FDB927&quot;</span><span class="p">,</span>
           <span class="s2">&quot;Lakers&quot;</span><span class="p">:</span> <span class="s2">&quot;#552583&quot;</span><span class="p">,</span>
           <span class="s2">&quot;Clippers&quot;</span><span class="p">:</span> <span class="s2">&quot;#C8102E&quot;</span><span class="p">,</span>
           <span class="s2">&quot;Kings&quot;</span><span class="p">:</span> <span class="s2">&quot;#5A2D81&quot;</span><span class="p">,</span>
           <span class="s2">&quot;Suns&quot;</span><span class="p">:</span> <span class="s2">&quot;#E56020&quot;</span><span class="p">}</span>


<span class="n">southwest</span><span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Mavericks&quot;</span><span class="p">:</span> <span class="s2">&quot;#00538C&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Rockets&quot;</span><span class="p">:</span> <span class="s2">&quot;#CE1141&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Grizzlies&quot;</span><span class="p">:</span> <span class="s2">&quot;#5D76A9&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Pelicans&quot;</span><span class="p">:</span> <span class="s2">&quot;#85714D&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Spurs&quot;</span><span class="p">:</span> <span class="s2">&quot;#C4CED4&quot;</span><span class="p">}</span>

<span class="n">nba_league</span> <span class="o">=</span> <span class="p">[</span><span class="n">atlantic</span><span class="p">,</span> <span class="n">central</span><span class="p">,</span> <span class="n">southeast</span><span class="p">,</span> <span class="n">northwest</span><span class="p">,</span> <span class="n">pacific</span><span class="p">,</span> <span class="n">southwest</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># 6 rows x 5 columns for all 30 teams</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># plot title</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;More Money, More Wins&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.55</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> 

<span class="c1"># Subplots spacing</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=.</span><span class="mo">001</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.925</span><span class="p">)</span>

<span class="c1"># ax[count][pos]: the axes object contains a numpy array</span>
<span class="c1"># count indicates the row</span>
<span class="c1"># pos indicates the column</span>
<span class="c1"># loop through each division, each team</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">nba_league</span><span class="p">:</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">0</span> 
    <span class="k">for</span> <span class="n">team</span><span class="p">,</span><span class="n">color</span> <span class="ow">in</span> <span class="n">division</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">plot_team_row</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="n">final</span><span class="p">[</span><span class="s1">&#39;team&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">team</span><span class="p">],</span> <span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">],</span><span class="n">color</span><span class="p">)</span>
        <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># labels</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Standardized Salary&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Win %&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># ticks</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.875</span><span class="p">,</span> <span class="s2">&quot;Atlantic&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.725</span><span class="p">,</span> <span class="s2">&quot;Central&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.575</span><span class="p">,</span> <span class="s2">&quot;Southeast&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.425</span><span class="p">,</span> <span class="s2">&quot;Northwest&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.275</span><span class="p">,</span> <span class="s2">&quot;Pacific&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.125</span><span class="p">,</span> <span class="s2">&quot;Southwest&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p><img alt="svg" src="images/nba_team_salary_40_0.svg"></p>
<div class="highlight"><pre><span></span><span class="c1"># plt.savefig(&#39;nba_team_salary.pdf&#39;)</span>
</pre></div>
  </div>



      <div class="footer">
<div class="disclaimer">

    <p>
      © Garry Chan 2019 &mdash; built with <a href="http://getpelican.com" target="_blank">Pelican</a>, built off of the theme <a href="https://github.com/swanson/lagom" target="_blank">Lagom</a>.
    </p>
  </div>      </div>
    </div>
  </div>

<!-- my kit for font awesome  -->
<script src="https://kit.fontawesome.com/54282dd713.js"></script>
</body>
</html>